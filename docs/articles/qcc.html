<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>A quick tour of qcc • qcc</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/sandstone/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="A quick tour of qcc">
<meta property="og:description" content="qcc">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">qcc</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">3.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/qcc.html">Vignette</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/luca-scr/qcc">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="qcc_files/header-attrs-2.1/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>A quick tour of qcc</h1>
                        <h4 class="author">Luca Scrucca</h4>
            
            <h4 class="date">28 Apr 2020</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/luca-scr/qcc/blob/master/vignettes/qcc.Rmd"><code>vignettes/qcc.Rmd</code></a></small>
      <div class="hidden name"><code>qcc.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p><code>qcc</code> is a contributed R package for <strong>statistical quality control charts</strong> which provides:</p>
<ul>
<li>Shewhart quality control charts for continuous, attribute and count data</li>
<li>Cusum and EWMA charts</li>
<li>Operating characteristic curves</li>
<li>Process capability analysis</li>
<li>Pareto chart and cause-and-effect chart</li>
<li>Multivariate control charts.</li>
</ul>
<p>This document gives a quick tour of <code>qcc</code> (version 3.0) functionalities. Further details are provided in Scrucca (2004). For a nice blog post discussing the <code>qcc</code> package, in particular how to implement the <em>Western Eletric Rules</em> (WER), see <a href="http://blog.yhat.com/posts/quality-control-in-r.html" class="uri">http://blog.yhat.com/posts/quality-control-in-r.html</a>.</p>
<p>This vignette is written in R Markdown using the <a href="https://cran.r-project.org/package=knitr">knitr</a> package for production.</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">qcc</span>)
<span class="co">##   __ _  ___ ___ </span>
<span class="co">##  / _  |/ __/ __|  Quality Control Charts and </span>
<span class="co">## | (_| | (_| (__   Statistical Process Control</span>
<span class="co">##  \__  |\___\___|</span>
<span class="co">##     |_|           version 3.0</span>
<span class="co">## Type 'citation("qcc")' for citing this R package in publications.</span></pre></body></html></div>
</div>
<div id="shewhart-charts" class="section level1">
<h1 class="hasAnchor">
<a href="#shewhart-charts" class="anchor"></a>Shewhart charts</h1>
<div id="x-bar-chart" class="section level2">
<h2 class="hasAnchor">
<a href="#x-bar-chart" class="anchor"></a>x-bar chart</h2>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="no">pistonrings</span>)
<span class="no">diameter</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/qccGroups.html">qccGroups</a></span>(<span class="no">diameter</span>, <span class="no">sample</span>, <span class="kw">data</span> <span class="kw">=</span> <span class="no">pistonrings</span>)
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">diameter</span>)
<span class="co">##     [,1]   [,2]   [,3]   [,4]   [,5]</span>
<span class="co">## 1 74.030 74.002 74.019 73.992 74.008</span>
<span class="co">## 2 73.995 73.992 74.001 74.011 74.004</span>
<span class="co">## 3 73.988 74.024 74.021 74.005 74.002</span>
<span class="co">## 4 74.002 73.996 73.993 74.015 74.009</span>
<span class="co">## 5 73.992 74.007 74.015 73.989 74.014</span>
<span class="co">## 6 74.009 73.994 73.997 73.985 73.993</span>

(<span class="no">q1</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/qcc.html">qcc</a></span>(<span class="no">diameter</span>[<span class="fl">1</span>:<span class="fl">25</span>,], <span class="kw">type</span><span class="kw">=</span><span class="st">"xbar"</span>, <span class="kw">newdata</span><span class="kw">=</span><span class="no">diameter</span>[<span class="fl">26</span>:<span class="fl">40</span>,]))</pre></body></html></div>
<p><img src="qcc_files/figure-html/unnamed-chunk-2-1.png" width="90%" style="display: block; margin: auto;"></p>
<pre><code><a href="https://rdrr.io/r/graphics/plot.html">## ── Quality Control Chart ───────────────────────── 
## 
## Chart type                 = xbar 
## Data (phase I)             = diameter[1:25, ] 
## Number of groups           = 25 
## Group sample size          = 5 
## Center of group statistics = 74.00118 
## Standard deviation         = 0.009785039 
## 
## New data (phase II)        = diameter[26:40, ] 
## Number of groups           = 15 
## Group sample size          = 5 
## 
## Control limits at nsigmas  = 3 
##       LCL     UCL
##  73.98805 74.0143
plot(q1, fill = FALSE)</a></code></pre>
<p><img src="qcc_files/figure-html/unnamed-chunk-2-2.png" width="90%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(<span class="no">q1</span>, <span class="kw">chart.all</span><span class="kw">=</span><span class="fl">FALSE</span>)</pre></body></html></div>
<p><img src="qcc_files/figure-html/unnamed-chunk-2-3.png" width="90%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(<span class="no">q1</span>, <span class="kw">add.stats</span><span class="kw">=</span><span class="fl">FALSE</span>)</pre></body></html></div>
<p><img src="qcc_files/figure-html/unnamed-chunk-2-4.png" width="90%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="no">q1</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/qcc.html">qcc</a></span>(<span class="no">diameter</span>[<span class="fl">1</span>:<span class="fl">25</span>,], <span class="kw">type</span><span class="kw">=</span><span class="st">"xbar"</span>, <span class="kw">newdata</span><span class="kw">=</span><span class="no">diameter</span>[<span class="fl">26</span>:<span class="fl">40</span>,], <span class="kw">confidence.level</span><span class="kw">=</span><span class="fl">0.99</span>)</pre></body></html></div>
<p><img src="qcc_files/figure-html/unnamed-chunk-2-5.png" width="90%" style="display: block; margin: auto;"></p>
<p>Western Electric rules:</p>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="no">q1</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/qcc.html">qcc</a></span>(<span class="no">diameter</span>[<span class="fl">1</span>:<span class="fl">25</span>,], <span class="kw">type</span><span class="kw">=</span><span class="st">"xbar"</span>, <span class="kw">newdata</span><span class="kw">=</span><span class="no">diameter</span>[<span class="fl">26</span>:<span class="fl">40</span>,], <span class="kw">rules</span> <span class="kw">=</span> <span class="fl">1</span>:<span class="fl">4</span>)</pre></body></html></div>
<p><img src="qcc_files/figure-html/unnamed-chunk-3-1.png" width="90%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(<span class="no">q1</span>, <span class="kw">fill</span> <span class="kw">=</span> <span class="fl">FALSE</span>)</pre></body></html></div>
<p><img src="qcc_files/figure-html/unnamed-chunk-3-2.png" width="90%" style="display: block; margin: auto;"></p>
<p>Group labels can be provided as calendar dates. For instance,</p>
<div class="sourceCode" id="cb9"><html><body><pre class="r">(<span class="no">dates</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.Date</a></span>() - <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="no">diameter</span>)+<span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.Date</a></span>(), <span class="kw">by</span> <span class="kw">=</span> <span class="fl">1</span>))
<span class="co">##  [1] "2020-03-20" "2020-03-21" "2020-03-22" "2020-03-23" "2020-03-24"</span>
<span class="co">##  [6] "2020-03-25" "2020-03-26" "2020-03-27" "2020-03-28" "2020-03-29"</span>
<span class="co">## [11] "2020-03-30" "2020-03-31" "2020-04-01" "2020-04-02" "2020-04-03"</span>
<span class="co">## [16] "2020-04-04" "2020-04-05" "2020-04-06" "2020-04-07" "2020-04-08"</span>
<span class="co">## [21] "2020-04-09" "2020-04-10" "2020-04-11" "2020-04-12" "2020-04-13"</span>
<span class="co">## [26] "2020-04-14" "2020-04-15" "2020-04-16" "2020-04-17" "2020-04-18"</span>
<span class="co">## [31] "2020-04-19" "2020-04-20" "2020-04-21" "2020-04-22" "2020-04-23"</span>
<span class="co">## [36] "2020-04-24" "2020-04-25" "2020-04-26" "2020-04-27" "2020-04-28"</span>
<span class="fu"><a href="../reference/qcc.html">qcc</a></span>(<span class="no">diameter</span>[<span class="fl">1</span>:<span class="fl">25</span>,], <span class="kw">type</span><span class="kw">=</span><span class="st">"xbar"</span>, <span class="kw">newdata</span><span class="kw">=</span><span class="no">diameter</span>[<span class="fl">26</span>:<span class="fl">40</span>,],
    <span class="kw">labels</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/format.html">format</a></span>(<span class="no">dates</span>[<span class="fl">1</span>:<span class="fl">25</span>], <span class="st">"%d %b"</span>), <span class="kw">newlabels</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/format.html">format</a></span>(<span class="no">dates</span>[<span class="fl">26</span>:<span class="fl">40</span>], <span class="st">"%d %b"</span>),
    <span class="kw">axes.las</span> <span class="kw">=</span> <span class="fl">3</span>, <span class="kw">xlab</span> <span class="kw">=</span> <span class="st">""</span>)</pre></body></html></div>
<p><img src="qcc_files/figure-html/unnamed-chunk-4-1.png" width="90%" style="display: block; margin: auto;"></p>
<pre><code>## ── Quality Control Chart ───────────────────────── 
## 
## Chart type                 = xbar 
## Data (phase I)             = diameter[1:25, ] 
## Number of groups           = 25 
## Group sample size          = 5 
## Center of group statistics = 74.00118 
## Standard deviation         = 0.009785039 
## 
## New data (phase II)        = diameter[26:40, ] 
## Number of groups           = 15 
## Group sample size          = 5 
## 
## Control limits at nsigmas  = 3 
##       LCL     UCL
##  73.98805 74.0143</code></pre>
<p>or by assigning dates to <code>data.frame</code> row names:</p>
<div class="sourceCode" id="cb11"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">diameter</span>) <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/format.html">format</a></span>(<span class="no">dates</span>, <span class="st">"%d %b"</span>)
<span class="fu"><a href="../reference/qcc.html">qcc</a></span>(<span class="no">diameter</span>[<span class="fl">1</span>:<span class="fl">25</span>,], <span class="kw">type</span><span class="kw">=</span><span class="st">"xbar"</span>, <span class="kw">newdata</span><span class="kw">=</span><span class="no">diameter</span>[<span class="fl">26</span>:<span class="fl">40</span>,],
    <span class="kw">axes.las</span> <span class="kw">=</span> <span class="fl">3</span>, <span class="kw">xlab</span> <span class="kw">=</span> <span class="st">""</span>)</pre></body></html></div>
</div>
<div id="r-chart" class="section level2">
<h2 class="hasAnchor">
<a href="#r-chart" class="anchor"></a>R chart</h2>
<div class="sourceCode" id="cb12"><html><body><pre class="r">(<span class="no">q2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/qcc.html">qcc</a></span>(<span class="no">diameter</span>[<span class="fl">1</span>:<span class="fl">25</span>,], <span class="kw">type</span><span class="kw">=</span><span class="st">"R"</span>))</pre></body></html></div>
<p><img src="qcc_files/figure-html/unnamed-chunk-6-1.png" width="90%" style="display: block; margin: auto;"></p>
<pre><code>## ── Quality Control Chart ───────────────────────── 
## 
## Chart type                 = R 
## Data (phase I)             = diameter[1:25, ] 
## Number of groups           = 25 
## Group sample size          = 5 
## Center of group statistics = 0.02276 
## Standard deviation         = 0.009785039 
## 
## Control limits at nsigmas  = 3 
##  LCL        UCL
##    0 0.04812533
(q3 &lt;- qcc(diameter[1:25,], type="R", newdata=diameter[26:40,]))</code></pre>
<p><img src="qcc_files/figure-html/unnamed-chunk-6-2.png" width="90%" style="display: block; margin: auto;"></p>
<pre><code>## ── Quality Control Chart ───────────────────────── 
## 
## Chart type                 = R 
## Data (phase I)             = diameter[1:25, ] 
## Number of groups           = 25 
## Group sample size          = 5 
## Center of group statistics = 0.02276 
## Standard deviation         = 0.009785039 
## 
## New data (phase II)        = diameter[26:40, ] 
## Number of groups           = 15 
## Group sample size          = 5 
## 
## Control limits at nsigmas  = 3 
##  LCL        UCL
##    0 0.04812533</code></pre>
</div>
<div id="s-chart" class="section level2">
<h2 class="hasAnchor">
<a href="#s-chart" class="anchor"></a>S chart</h2>
<div class="sourceCode" id="cb15"><html><body><pre class="r">(<span class="no">q4</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/qcc.html">qcc</a></span>(<span class="no">diameter</span>[<span class="fl">1</span>:<span class="fl">25</span>,], <span class="kw">type</span><span class="kw">=</span><span class="st">"S"</span>))</pre></body></html></div>
<p><img src="qcc_files/figure-html/unnamed-chunk-7-1.png" width="90%" style="display: block; margin: auto;"></p>
<pre><code>## ── Quality Control Chart ───────────────────────── 
## 
## Chart type                 = S 
## Data (phase I)             = diameter[1:25, ] 
## Number of groups           = 25 
## Group sample size          = 5 
## Center of group statistics = 0.009240037 
## Standard deviation         = 0.009829977 
## 
## Control limits at nsigmas  = 3 
##  LCL        UCL
##    0 0.01930242
(q5 &lt;- qcc(diameter[1:25,], type="S", newdata=diameter[26:40,]))</code></pre>
<p><img src="qcc_files/figure-html/unnamed-chunk-7-2.png" width="90%" style="display: block; margin: auto;"></p>
<pre><code>## ── Quality Control Chart ───────────────────────── 
## 
## Chart type                 = S 
## Data (phase I)             = diameter[1:25, ] 
## Number of groups           = 25 
## Group sample size          = 5 
## Center of group statistics = 0.009240037 
## Standard deviation         = 0.009829977 
## 
## New data (phase II)        = diameter[26:40, ] 
## Number of groups           = 15 
## Group sample size          = 5 
## 
## Control limits at nsigmas  = 3 
##  LCL        UCL
##    0 0.01930242</code></pre>
</div>
<div id="variable-control-limits-in-control-charts" class="section level2">
<h2 class="hasAnchor">
<a href="#variable-control-limits-in-control-charts" class="anchor"></a>Variable control limits in control charts</h2>
<div class="sourceCode" id="cb18"><html><body><pre class="r"><span class="no">out</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">9</span>, <span class="fl">10</span>, <span class="fl">30</span>, <span class="fl">35</span>, <span class="fl">45</span>, <span class="fl">64</span>, <span class="fl">65</span>, <span class="fl">74</span>, <span class="fl">75</span>, <span class="fl">85</span>, <span class="fl">99</span>, <span class="fl">100</span>)
<span class="no">diameter2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/qccGroups.html">qccGroups</a></span>(<span class="no">diameter</span>, <span class="no">sample</span>, <span class="kw">data</span> <span class="kw">=</span> <span class="no">pistonrings</span>[-<span class="no">out</span>,])
<span class="fu"><a href="../reference/qcc.html">qcc</a></span>(<span class="no">diameter2</span>[<span class="fl">1</span>:<span class="fl">25</span>,], <span class="kw">type</span><span class="kw">=</span><span class="st">"xbar"</span>)</pre></body></html></div>
<p><img src="qcc_files/figure-html/unnamed-chunk-8-1.png" width="90%" style="display: block; margin: auto;"></p>
<pre><code><a href="../reference/qcc.html">## ── Quality Control Chart ───────────────────────── 
## 
## Chart type                 = xbar 
## Data (phase I)             = diameter2[1:25, ] 
## Number of groups           = 25 
## Group sample sizes         =               
##   sizes  3 4  5
##   counts 4 4 17
## Center of group statistics = 74.00075 
## Standard deviation         = 0.009856701 
## 
## Control limits at nsigmas  = 3 
##        LCL      UCL
##   73.98753 74.01398
##   73.98368 74.01782
## :                  
##   73.98753 74.01398
qcc(diameter2[1:25,], type="R")</a></code></pre>
<p><img src="qcc_files/figure-html/unnamed-chunk-8-2.png" width="90%" style="display: block; margin: auto;"></p>
<pre><code>## ── Quality Control Chart ───────────────────────── 
## 
## Chart type                 = R 
## Data (phase I)             = diameter2[1:25, ] 
## Number of groups           = 25 
## Group sample sizes         =               
##   sizes  3 4  5
##   counts 4 4 17
## Center of group statistics = 0.02230088 
## Standard deviation         = 0.009856701 
## 
## Control limits at nsigmas  = 3 
##   LCL        UCL
##     0 0.04785198
##     0 0.04857007
## :               
##     0 0.04785198</code></pre>
<div class="sourceCode" id="cb21"><html><body><pre class="r"><span class="no">q</span> <span class="kw">=</span> <span class="fu"><a href="../reference/qcc.html">qcc</a></span>(<span class="no">diameter2</span>[<span class="fl">1</span>:<span class="fl">25</span>,], <span class="kw">type</span><span class="kw">=</span><span class="st">"xbar"</span>, <span class="kw">rules</span> <span class="kw">=</span> <span class="fl">1</span>:<span class="fl">4</span>)</pre></body></html></div>
<p><img src="qcc_files/figure-html/unnamed-chunk-9-1.png" width="90%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb22"><html><body><pre class="r"><span class="fu"><a href="../reference/qcc.html">qcc</a></span>(<span class="no">diameter2</span>[<span class="fl">1</span>:<span class="fl">25</span>,], <span class="kw">type</span><span class="kw">=</span><span class="st">"xbar"</span>, <span class="kw">newdata</span><span class="kw">=</span><span class="no">diameter2</span>[<span class="fl">26</span>:<span class="fl">40</span>,], <span class="kw">rules</span> <span class="kw">=</span> <span class="fl">1</span>:<span class="fl">4</span>)</pre></body></html></div>
<p><img src="qcc_files/figure-html/unnamed-chunk-9-2.png" width="90%" style="display: block; margin: auto;"></p>
<pre><code>## ── Quality Control Chart ───────────────────────── 
## 
## Chart type                 = xbar 
## Data (phase I)             = diameter2[1:25, ] 
## Number of groups           = 25 
## Group sample sizes         =               
##   sizes  3 4  5
##   counts 4 4 17
## Center of group statistics = 74.00075 
## Standard deviation         = 0.009856701 
## 
## New data (phase II)        = diameter2[26:40, ] 
## Number of groups           = 15 
## Group sample size          = 5 
## 
## Control limits at nsigmas  = 3 
##        LCL      UCL
##   73.98753 74.01398
##   73.98368 74.01782
## :                  
##   73.98753 74.01398</code></pre>
</div>
<div id="p-and-np-charts" class="section level2">
<h2 class="hasAnchor">
<a href="#p-and-np-charts" class="anchor"></a>p and np charts</h2>
<div class="sourceCode" id="cb24"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="no">orangejuice</span>)
<span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span>(<span class="no">orangejuice</span>, <span class="fu"><a href="../reference/qcc.html">qcc</a></span>(<span class="no">D</span>[<span class="no">trial</span>], <span class="kw">sizes</span><span class="kw">=</span><span class="no">size</span>[<span class="no">trial</span>], <span class="kw">type</span><span class="kw">=</span><span class="st">"p"</span>))</pre></body></html></div>
<p><img src="qcc_files/figure-html/unnamed-chunk-10-1.png" width="90%" style="display: block; margin: auto;"></p>
<pre><code><a href="https://rdrr.io/r/base/with.html">## ── Quality Control Chart ───────────────────────── 
## 
## Chart type                 = p 
## Data (phase I)             = D[trial] 
## Number of groups           = 30 
## Group sample size          = 50 
## Center of group statistics = 0.2313333 
## Standard deviation         = 0.421685 
## 
## Control limits at nsigmas  = 3 
##          LCL       UCL
##   0.05242755 0.4102391
##   0.05242755 0.4102391
## :                     
##   0.05242755 0.4102391
with(orangejuice, qcc(D[trial], sizes=size[trial], type="np"))</a></code></pre>
<p><img src="qcc_files/figure-html/unnamed-chunk-10-2.png" width="90%" style="display: block; margin: auto;"></p>
<pre><code>## ── Quality Control Chart ───────────────────────── 
## 
## Chart type                 = np 
## Data (phase I)             = D[trial] 
## Number of groups           = 30 
## Group sample size          = 50 
## Center of group statistics = 11.56667 
## Standard deviation         = 2.981763 
## 
## Control limits at nsigmas  = 3 
##       LCL      UCL
##  2.621377 20.51196</code></pre>
<p>Remove out-of-control points (see <code><a href="../reference/orangejuice.html">help(orangejuice)</a></code> for the reasons):</p>
<div class="sourceCode" id="cb27"><html><body><pre class="r"><span class="no">inc</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sets.html">setdiff</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span>(<span class="no">orangejuice</span>$<span class="no">trial</span>), <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">15</span>,<span class="fl">23</span>))
<span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span>(<span class="no">orangejuice</span>, <span class="fu"><a href="../reference/qcc.html">qcc</a></span>(<span class="no">D</span>[<span class="no">inc</span>], <span class="kw">sizes</span><span class="kw">=</span><span class="no">size</span>[<span class="no">inc</span>], <span class="kw">type</span><span class="kw">=</span><span class="st">"p"</span>,
                      <span class="kw">newdata</span><span class="kw">=</span><span class="no">D</span>[!<span class="no">trial</span>], <span class="kw">newsizes</span><span class="kw">=</span><span class="no">size</span>[!<span class="no">trial</span>]))</pre></body></html></div>
<p><img src="qcc_files/figure-html/unnamed-chunk-11-1.png" width="90%" style="display: block; margin: auto;"></p>
<pre><code>## ── Quality Control Chart ───────────────────────── 
## 
## Chart type                 = p 
## Data (phase I)             = D[inc] 
## Number of groups           = 28 
## Group sample size          = 50 
## Center of group statistics = 0.215 
## Standard deviation         = 0.4108223 
## 
## New data (phase II)        = D[!trial] 
## Number of groups           = 24 
## Group sample size          = 50 
## 
## Control limits at nsigmas  = 3 
##          LCL       UCL
##   0.04070284 0.3892972
##   0.04070284 0.3892972
## :                     
##   0.04070284 0.3892972</code></pre>
<div class="sourceCode" id="cb29"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="no">orangejuice2</span>)
<span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span>(<span class="no">orangejuice2</span>, <span class="fu"><a href="../reference/qcc.html">qcc</a></span>(<span class="no">D</span>[<span class="no">trial</span>], <span class="kw">sizes</span><span class="kw">=</span><span class="no">size</span>[<span class="no">trial</span>], <span class="kw">type</span><span class="kw">=</span><span class="st">"p"</span>,
                       <span class="kw">newdata</span><span class="kw">=</span><span class="no">D</span>[!<span class="no">trial</span>], <span class="kw">newsizes</span><span class="kw">=</span><span class="no">size</span>[!<span class="no">trial</span>]))</pre></body></html></div>
<p><img src="qcc_files/figure-html/unnamed-chunk-12-1.png" width="90%" style="display: block; margin: auto;"></p>
<pre><code>## ── Quality Control Chart ───────────────────────── 
## 
## Chart type                 = p 
## Data (phase I)             = D[trial] 
## Number of groups           = 24 
## Group sample size          = 50 
## Center of group statistics = 0.1108333 
## Standard deviation         = 0.3139256 
## 
## New data (phase II)        = D[!trial] 
## Number of groups           = 40 
## Group sample size          = 50 
## 
## Control limits at nsigmas  = 3 
##   LCL       UCL
##     0 0.2440207
##     0 0.2440207
## :              
##     0 0.2440207</code></pre>
</div>
<div id="c-and-u-charts" class="section level2">
<h2 class="hasAnchor">
<a href="#c-and-u-charts" class="anchor"></a>c and u charts</h2>
<div class="sourceCode" id="cb31"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="no">circuit</span>)
<span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span>(<span class="no">circuit</span>, <span class="fu"><a href="../reference/qcc.html">qcc</a></span>(<span class="no">x</span>[<span class="no">trial</span>], <span class="kw">sizes</span><span class="kw">=</span><span class="no">size</span>[<span class="no">trial</span>], <span class="kw">type</span><span class="kw">=</span><span class="st">"c"</span>))</pre></body></html></div>
<p><img src="qcc_files/figure-html/unnamed-chunk-13-1.png" width="90%" style="display: block; margin: auto;"></p>
<pre><code>## ── Quality Control Chart ───────────────────────── 
## 
## Chart type                 = c 
## Data (phase I)             = x[trial] 
## Number of groups           = 26 
## Group sample size          = 100 
## Center of group statistics = 19.84615 
## Standard deviation         = 4.454902 
## 
## Control limits at nsigmas  = 3 
##       LCL      UCL
##  6.481447 33.21086</code></pre>
<p>Remove out-of-control points (see <code><a href="../reference/circuit.html">help(circuit)</a></code> for the reasons)</p>
<div class="sourceCode" id="cb33"><html><body><pre class="r"><span class="no">inc</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sets.html">setdiff</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span>(<span class="no">circuit</span>$<span class="no">trial</span>), <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">6</span>,<span class="fl">20</span>))
<span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span>(<span class="no">circuit</span>, <span class="fu"><a href="../reference/qcc.html">qcc</a></span>(<span class="no">x</span>[<span class="no">inc</span>], <span class="kw">sizes</span><span class="kw">=</span><span class="no">size</span>[<span class="no">inc</span>], <span class="kw">type</span><span class="kw">=</span><span class="st">"c"</span>, <span class="kw">labels</span><span class="kw">=</span><span class="no">inc</span>,
                  <span class="kw">newdata</span><span class="kw">=</span><span class="no">x</span>[!<span class="no">trial</span>], <span class="kw">newsizes</span><span class="kw">=</span><span class="no">size</span>[!<span class="no">trial</span>],
                  <span class="kw">newlabels</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span>(!<span class="no">trial</span>)))</pre></body></html></div>
<p><img src="qcc_files/figure-html/unnamed-chunk-14-1.png" width="90%" style="display: block; margin: auto;"></p>
<pre><code><a href="https://rdrr.io/r/base/with.html">## ── Quality Control Chart ───────────────────────── 
## 
## Chart type                 = c 
## Data (phase I)             = x[inc] 
## Number of groups           = 24 
## Group sample size          = 100 
## Center of group statistics = 19.66667 
## Standard deviation         = 4.434712 
## 
## New data (phase II)        = x[!trial] 
## Number of groups           = 20 
## Group sample size          = 100 
## 
## Control limits at nsigmas  = 3 
##       LCL     UCL
##  6.362532 32.9708

with(circuit, qcc(x[inc], sizes=size[inc], type="u", labels=inc, 
                  newdata=x[!trial], newsizes=size[!trial], 
                  newlabels=which(!trial)))</a></code></pre>
<p><img src="qcc_files/figure-html/unnamed-chunk-14-2.png" width="90%" style="display: block; margin: auto;"></p>
<pre><code>## ── Quality Control Chart ───────────────────────── 
## 
## Chart type                 = u 
## Data (phase I)             = x[inc] 
## Number of groups           = 24 
## Group sample size          = 100 
## Center of group statistics = 0.1966667 
## Standard deviation         = 0.4434712 
## 
## New data (phase II)        = x[!trial] 
## Number of groups           = 20 
## Group sample size          = 100 
## 
## Control limits at nsigmas  = 3 
##         LCL      UCL
##  0.06362532 0.329708</code></pre>
<div class="sourceCode" id="cb36"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="no">pcmanufact</span>)
<span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span>(<span class="no">pcmanufact</span>, <span class="fu"><a href="../reference/qcc.html">qcc</a></span>(<span class="no">x</span>, <span class="kw">sizes</span><span class="kw">=</span><span class="no">size</span>, <span class="kw">type</span><span class="kw">=</span><span class="st">"u"</span>))</pre></body></html></div>
<p><img src="qcc_files/figure-html/unnamed-chunk-15-1.png" width="90%" style="display: block; margin: auto;"></p>
<pre><code>## ── Quality Control Chart ───────────────────────── 
## 
## Chart type                 = u 
## Data (phase I)             = x 
## Number of groups           = 20 
## Group sample size          = 5 
## Center of group statistics = 1.93 
## Standard deviation         = 1.389244 
## 
## Control limits at nsigmas  = 3 
##         LCL      UCL
##  0.06613305 3.793867</code></pre>
</div>
<div id="continuous-one-at-time-data" class="section level2">
<h2 class="hasAnchor">
<a href="#continuous-one-at-time-data" class="anchor"></a>Continuous one-at-time data</h2>
<div class="sourceCode" id="cb38"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="no">viscosity</span>)
<span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span>(<span class="no">viscosity</span>,
     <span class="fu"><a href="../reference/qcc.html">qcc</a></span>(<span class="no">viscosity</span>[<span class="no">trial</span>], <span class="kw">type</span> <span class="kw">=</span> <span class="st">"xbar.one"</span>, <span class="kw">labels</span> <span class="kw">=</span> <span class="no">batch</span>[<span class="no">trial</span>]))</pre></body></html></div>
<p><img src="qcc_files/figure-html/unnamed-chunk-16-1.png" width="90%" style="display: block; margin: auto;"></p>
<pre><code><a href="https://rdrr.io/r/base/with.html">## ── Quality Control Chart ───────────────────────── 
## 
## Chart type                 = xbar.one 
## Data (phase I)             = viscosity[trial] 
## Number of groups           = 20 
## Group sample size          = 1 
## Center of group statistics = 34.088 
## Standard deviation         = 0.5076521 
## 
## Control limits at nsigmas  = 3 
##       LCL      UCL
##  32.56504 35.61096
with(viscosity, 
     qcc(viscosity[trial], type = "xbar.one", labels = batch[trial],
         std.dev = "SD"))</a></code></pre>
<p><img src="qcc_files/figure-html/unnamed-chunk-16-2.png" width="90%" style="display: block; margin: auto;"></p>
<pre><code>## ── Quality Control Chart ───────────────────────── 
## 
## Chart type                 = xbar.one 
## Data (phase I)             = viscosity[trial] 
## Number of groups           = 20 
## Group sample size          = 1 
## Center of group statistics = 34.088 
## Standard deviation         = 0.5769854 
## 
## Control limits at nsigmas  = 3 
##       LCL      UCL
##  32.35704 35.81896
# batch 4 is out-of-control because of a process temperature controller
# failure; remove it and recompute
viscosity &lt;- viscosity[-4,]
with(viscosity, 
     qcc(viscosity[trial], type = "xbar.one", labels = batch[trial],
         newdata = viscosity[!trial], newlabels = batch[!trial],
         rules = 1:4))</code></pre>
<p><img src="qcc_files/figure-html/unnamed-chunk-16-3.png" width="90%" style="display: block; margin: auto;"></p>
<pre><code>## ── Quality Control Chart ───────────────────────── 
## 
## Chart type                 = xbar.one 
## Data (phase I)             = viscosity[trial] 
## Number of groups           = 19 
## Group sample size          = 1 
## Center of group statistics = 33.98947 
## Standard deviation         = 0.4117415 
## 
## New data (phase II)        = viscosity[!trial] 
## Number of groups           = 15 
## Group sample size          = 1 
## 
## Control limits at nsigmas  = 3 
##       LCL     UCL
##  32.75425 35.2247</code></pre>
</div>
<div id="standardized-p-chart" class="section level2">
<h2 class="hasAnchor">
<a href="#standardized-p-chart" class="anchor"></a>Standardized p chart</h2>
<p>In this example we show how to extend the package by defining a new control chart, i.e. a standardized p chart (<code>type = "p.std"</code>).</p>
<p>Function to compute group statistics and center:</p>
<div class="sourceCode" id="cb42"><html><body><pre class="r"><span class="no">stats.p.std</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">data</span>, <span class="no">sizes</span>)
{
  <span class="no">data</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html">as.vector</a></span>(<span class="no">data</span>)
  <span class="no">sizes</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html">as.vector</a></span>(<span class="no">sizes</span>)
  <span class="no">pbar</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="no">data</span>)/<span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="no">sizes</span>)
  <span class="no">z</span> <span class="kw">&lt;-</span> (<span class="no">data</span>/<span class="no">sizes</span> - <span class="no">pbar</span>)/<span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(<span class="no">pbar</span>*(<span class="fl">1</span>-<span class="no">pbar</span>)/<span class="no">sizes</span>)
  <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">statistics</span> <span class="kw">=</span> <span class="no">z</span>, <span class="kw">center</span> <span class="kw">=</span> <span class="fl">0</span>)
}</pre></body></html></div>
<p>Function to compute within-group standard deviation:</p>
<div class="sourceCode" id="cb43"><html><body><pre class="r"><span class="no">sd.p.std</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">data</span>, <span class="no">sizes</span>, <span class="no">...</span>) { <span class="fu"><a href="https://rdrr.io/r/base/function.html">return</a></span>(<span class="fl">1</span>) }</pre></body></html></div>
<p>Function to compute control limits based on normal approximation:</p>
<div class="sourceCode" id="cb44"><html><body><pre class="r"><span class="no">limits.p.std</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">center</span>, <span class="no">std.dev</span>, <span class="no">sizes</span>, <span class="no">nsigmas</span> <span class="kw">=</span> <span class="kw">NULL</span>, <span class="no">conf</span> <span class="kw">=</span> <span class="kw">NULL</span>)
{
  <span class="kw">if</span>(<span class="fu"><a href="https://rdrr.io/r/base/NULL.html">is.null</a></span>(<span class="no">conf</span>))
    { <span class="no">lcl</span> <span class="kw">&lt;-</span> -<span class="no">nsigmas</span>
      <span class="no">ucl</span> <span class="kw">&lt;-</span> +<span class="no">nsigmas</span>
  } <span class="kw">else</span>
    { <span class="kw">if</span>(<span class="no">conf</span> <span class="kw">&gt;</span> <span class="fl">0</span> <span class="kw">&amp;</span> <span class="no">conf</span> <span class="kw">&lt;</span> <span class="fl">1</span>)
        { <span class="no">nsigmas</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span>(<span class="fl">1</span> - (<span class="fl">1</span> - <span class="no">conf</span>)/<span class="fl">2</span>)
          <span class="no">lcl</span> <span class="kw">&lt;-</span> -<span class="no">nsigmas</span>
          <span class="no">ucl</span> <span class="kw">&lt;-</span> +<span class="no">nsigmas</span> }
      <span class="kw">else</span> <span class="fu"><a href="https://rdrr.io/r/base/stop.html">stop</a></span>(<span class="st">"invalid 'conf' argument."</span>)
  }
  <span class="no">limits</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">lcl</span>, <span class="no">ucl</span>), <span class="kw">ncol</span> <span class="kw">=</span> <span class="fl">2</span>)
  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">limits</span>) <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="st">""</span>, <span class="kw">length</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="no">limits</span>))
  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">limits</span>) <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"LCL"</span>, <span class="st">"UCL"</span>)
  <span class="fu"><a href="https://rdrr.io/r/base/function.html">return</a></span>(<span class="no">limits</span>)
}</pre></body></html></div>
<p>Example with simulated data:</p>
<div class="sourceCode" id="cb45"><html><body><pre class="r"><span class="co"># set unequal sample sizes</span>
<span class="no">n</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">50</span>,<span class="fl">5</span>), <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">100</span>,<span class="fl">5</span>), <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">25</span>, <span class="fl">5</span>))
<span class="co"># generate randomly the number of successes</span>
<span class="no">x</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">rbinom</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">n</span>), <span class="no">n</span>, <span class="fl">0.2</span>)
<span class="co"># plot the control chart with variable limits</span>
<span class="fu"><a href="../reference/qcc.html">qcc</a></span>(<span class="no">x</span>, <span class="kw">type</span><span class="kw">=</span><span class="st">"p"</span>, <span class="kw">size</span><span class="kw">=</span><span class="no">n</span>)</pre></body></html></div>
<p><img src="qcc_files/figure-html/unnamed-chunk-20-1.png" width="90%" style="display: block; margin: auto;"></p>
<pre><code><a href="../reference/qcc.html">## ── Quality Control Chart ───────────────────────── 
## 
## Chart type                 = p 
## Data (phase I)             = x 
## Number of groups           = 15 
## Group sample sizes         =                  
##   sizes  25 50 100
##   counts  5  5   5
## Center of group statistics = 0.2148571 
## Standard deviation         = 0.4107232 
## 
## Control limits at nsigmas  = 3 
##          LCL       UCL
##   0.04060204 0.3891122
##   0.04060204 0.3891122
## :                     
##   0.00000000 0.4612911
# plot the standardized control chart
qcc(x, type="p.std", size=n)</a></code></pre>
<p><img src="qcc_files/figure-html/unnamed-chunk-20-2.png" width="90%" style="display: block; margin: auto;"></p>
<pre><code>## ── Quality Control Chart ───────────────────────── 
## 
## Chart type                 = p.std 
## Data (phase I)             = x 
## Number of groups           = 15 
## Group sample sizes         =                  
##   sizes  25 50 100
##   counts  5  5   5
## Center of group statistics = 0 
## Standard deviation         = 1 
## 
## Control limits at nsigmas  = 3 
##  LCL UCL
##   -3   3</code></pre>
</div>
</div>
<div id="operating-characteristic-curves" class="section level1">
<h1 class="hasAnchor">
<a href="#operating-characteristic-curves" class="anchor"></a>Operating Characteristic Curves</h1>
<p>An operating characteristic curve graphically provides information about the probability of not detecting a shift in the process. The function <code><a href="../reference/oc.curves.html">ocCurves()</a></code> is a generic function which calls the proper function depending on the type of input <code>'qcc'</code> object.</p>
<div class="sourceCode" id="cb48"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="no">pistonrings</span>)
<span class="no">diameter</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/qccGroups.html">qccGroups</a></span>(<span class="no">diameter</span>, <span class="no">sample</span>, <span class="kw">data</span> <span class="kw">=</span> <span class="no">pistonrings</span>)
<span class="no">q</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/qcc.html">qcc</a></span>(<span class="no">diameter</span>, <span class="kw">type</span><span class="kw">=</span><span class="st">"xbar"</span>, <span class="kw">nsigmas</span><span class="kw">=</span><span class="fl">3</span>, <span class="kw">plot</span><span class="kw">=</span><span class="fl">FALSE</span>)
<span class="no">beta</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/oc.curves.html">ocCurves</a></span>(<span class="no">q</span>)</pre></body></html></div>
<p><img src="qcc_files/figure-html/unnamed-chunk-21-1.png" width="90%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb49"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">beta</span>, <span class="kw">n</span> <span class="kw">=</span> <span class="fl">10</span>), <span class="kw">digits</span> <span class="kw">=</span> <span class="fl">4</span>)
<span class="co">##                sample size</span>
<span class="co">## shift (std.dev)    n=1    n=5   n=10   n=15   n=20</span>
<span class="co">##            0    0.9973 0.9973 0.9973 0.9973 0.9973</span>
<span class="co">##            0.05 0.9973 0.9971 0.9970 0.9968 0.9966</span>
<span class="co">##            0.1  0.9972 0.9966 0.9959 0.9952 0.9944</span>
<span class="co">##            0.15 0.9970 0.9957 0.9940 0.9920 0.9900</span>
<span class="co">##            0.2  0.9968 0.9944 0.9909 0.9869 0.9823</span>
<span class="co">##            0.25 0.9964 0.9925 0.9864 0.9789 0.9701</span>
<span class="co">##            0.3  0.9960 0.9900 0.9798 0.9670 0.9514</span>
<span class="co">##            0.35 0.9956 0.9866 0.9708 0.9500 0.9243</span>
<span class="co">##            0.4  0.9950 0.9823 0.9586 0.9266 0.8871</span>
<span class="co">##            0.45 0.9943 0.9769 0.9426 0.8957 0.8383</span>

<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="no">orangejuice</span>)
<span class="no">q</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span>(<span class="no">orangejuice</span>, <span class="fu"><a href="../reference/qcc.html">qcc</a></span>(<span class="no">D</span>[<span class="no">trial</span>], <span class="kw">sizes</span><span class="kw">=</span><span class="no">size</span>[<span class="no">trial</span>], <span class="kw">type</span><span class="kw">=</span><span class="st">"p"</span>, <span class="kw">plot</span><span class="kw">=</span><span class="fl">FALSE</span>))
<span class="no">beta</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/oc.curves.html">ocCurves</a></span>(<span class="no">q</span>)</pre></body></html></div>
<p><img src="qcc_files/figure-html/unnamed-chunk-21-2.png" width="90%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb50"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">beta</span>, <span class="kw">n</span> <span class="kw">=</span> <span class="fl">10</span>), <span class="kw">digits</span> <span class="kw">=</span> <span class="fl">4</span>)
<span class="co">##       0    0.01    0.02    0.03    0.04    0.05    0.06    0.07    0.08    0.09 </span>
<span class="co">## 0.00000 0.08944 0.26423 0.44472 0.59952 0.72057 0.81000 0.87351 0.91729 0.94676</span>

<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="no">circuit</span>)
<span class="no">q</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span>(<span class="no">circuit</span>, <span class="fu"><a href="../reference/qcc.html">qcc</a></span>(<span class="no">x</span>[<span class="no">trial</span>], <span class="kw">sizes</span><span class="kw">=</span><span class="no">size</span>[<span class="no">trial</span>], <span class="kw">type</span><span class="kw">=</span><span class="st">"c"</span>, <span class="kw">plot</span><span class="kw">=</span><span class="fl">FALSE</span>))
<span class="no">beta</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/oc.curves.html">ocCurves</a></span>(<span class="no">q</span>)</pre></body></html></div>
<p><img src="qcc_files/figure-html/unnamed-chunk-21-3.png" width="90%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb51"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">beta</span>, <span class="kw">n</span> <span class="kw">=</span> <span class="fl">10</span>), <span class="kw">digits</span> <span class="kw">=</span> <span class="fl">4</span>)
<span class="co">##         0         1         2         3         4         5         6         7 </span>
<span class="co">## 0.0000000 0.0005942 0.0165636 0.0839179 0.2148696 0.3840393 0.5543204 0.6992917 </span>
<span class="co">##         8         9 </span>
<span class="co">## 0.8087639 0.8843095</span></pre></body></html></div>
</div>
<div id="cusum-chart" class="section level1">
<h1 class="hasAnchor">
<a href="#cusum-chart" class="anchor"></a>Cusum chart</h1>
<div class="sourceCode" id="cb52"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="no">pistonrings</span>)
<span class="no">diameter</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/qccGroups.html">qccGroups</a></span>(<span class="no">diameter</span>, <span class="no">sample</span>, <span class="kw">data</span> <span class="kw">=</span> <span class="no">pistonrings</span>)

<span class="fu"><a href="../reference/cusum.html">cusum</a></span>(<span class="no">diameter</span>[<span class="fl">1</span>:<span class="fl">25</span>,], <span class="kw">decision.interval</span> <span class="kw">=</span> <span class="fl">4</span>, <span class="kw">se.shift</span> <span class="kw">=</span> <span class="fl">1</span>)</pre></body></html></div>
<p><img src="qcc_files/figure-html/unnamed-chunk-22-1.png" width="90%" style="display: block; margin: auto;"></p>
<pre><code>## ── Cusum Chart ─────────────────────────────────── 
## 
## Data (phase I)             = diameter[1:25, ] 
## Number of groups           = 25 
## Group sample size          = 5 
## Center of group statistics = 74.00118 
## Standard deviation         = 0.009785039 
## 
## Decision interval (std.err.) = 4 
## Shift detection   (std.err.) = 1

(q &lt;- cusum(diameter[1:25,], newdata = diameter[26:40,]))</code></pre>
<p><img src="qcc_files/figure-html/unnamed-chunk-22-2.png" width="90%" style="display: block; margin: auto;"></p>
<pre><code><a href="https://rdrr.io/r/graphics/plot.html">## ── Cusum Chart ─────────────────────────────────── 
## 
## Data (phase I)             = diameter[1:25, ] 
## Number of groups           = 25 
## Group sample size          = 5 
## Center of group statistics = 74.00118 
## Standard deviation         = 0.009785039 
## 
## New data (phase II)        = diameter[26:40, ] 
## Number of groups           = 15 
## Group sample size          = 5 
## 
## Decision interval (std.err.) = 5 
## Shift detection   (std.err.) = 1
plot(q, chart.all=FALSE)</a></code></pre>
<p><img src="qcc_files/figure-html/unnamed-chunk-22-3.png" width="90%" style="display: block; margin: auto;"></p>
</div>
<div id="ewma" class="section level1">
<h1 class="hasAnchor">
<a href="#ewma" class="anchor"></a>EWMA</h1>
<div class="sourceCode" id="cb55"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="no">pistonrings</span>)
<span class="no">diameter</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/qccGroups.html">qccGroups</a></span>(<span class="no">diameter</span>, <span class="no">sample</span>, <span class="kw">data</span> <span class="kw">=</span> <span class="no">pistonrings</span>)

<span class="fu"><a href="../reference/ewma.html">ewma</a></span>(<span class="no">diameter</span>[<span class="fl">1</span>:<span class="fl">25</span>,], <span class="kw">lambda</span><span class="kw">=</span><span class="fl">0.2</span>, <span class="kw">nsigmas</span><span class="kw">=</span><span class="fl">3</span>)</pre></body></html></div>
<p><img src="qcc_files/figure-html/unnamed-chunk-23-1.png" width="90%" style="display: block; margin: auto;"></p>
<pre><code><a href="../reference/ewma.html">## ── EWMA Chart ──────────────────────────────────── 
## 
## Data (phase I)             = diameter[1:25, ] 
## Number of groups           = 25 
## Group sample size          = 5 
## Center of group statistics = 74.00118 
## Standard deviation         = 0.009785039 
## 
## Smoothing parameter        = 0.2 
## Control limits at nsigmas  = 3 
##         LCL      UCL
## 1  73.99855 74.00380
## 2  73.99781 74.00454
## :                   
## 25 73.99680 74.00555

ewma(diameter[1:25,], lambda=0.2, nsigmas=2.7, newdata=diameter[26:40,])</a></code></pre>
<p><img src="qcc_files/figure-html/unnamed-chunk-23-2.png" width="90%" style="display: block; margin: auto;"></p>
<pre><code>## ── EWMA Chart ──────────────────────────────────── 
## 
## Data (phase I)             = diameter[1:25, ] 
## Number of groups           = 25 
## Group sample size          = 5 
## Center of group statistics = 74.00118 
## Standard deviation         = 0.009785039 
## 
## New data (phase II)        = diameter[26:40, ] 
## Number of groups           = 15 
## Group sample size          = 5 
## 
## Smoothing parameter        = 0.2 
## Control limits at nsigmas  = 2.7 
##         LCL      UCL
## 1  73.99881 74.00354
## 2  73.99815 74.00420
## :                   
## 40 73.99724 74.00511</code></pre>
<div class="sourceCode" id="cb58"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="no">viscosity</span>)
<span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span>(<span class="no">viscosity</span>,
     <span class="fu"><a href="../reference/ewma.html">ewma</a></span>(<span class="no">viscosity</span>[<span class="no">trial</span>], <span class="kw">lambda</span><span class="kw">=</span><span class="fl">0.2</span>, <span class="kw">nsigmas</span><span class="kw">=</span><span class="fl">2.7</span>,
          <span class="kw">newdata</span> <span class="kw">=</span> <span class="no">viscosity</span>[!<span class="no">trial</span>]))</pre></body></html></div>
<p><img src="qcc_files/figure-html/unnamed-chunk-24-1.png" width="90%" style="display: block; margin: auto;"></p>
<pre><code>## ── EWMA Chart ──────────────────────────────────── 
## 
## Data (phase I)             = viscosity[trial] 
## Number of groups           = 20 
## Group sample size          = 1 
## Center of group statistics = 34.088 
## Standard deviation         = 0.5076521 
## 
## New data (phase II)        = viscosity[!trial] 
## Number of groups           = 15 
## Group sample size          = 1 
## 
## Smoothing parameter        = 0.2 
## Control limits at nsigmas  = 2.7 
##            LCL      UCL
## [1,]  33.81387 34.36213
## [2,]  33.73694 34.43906
## :                      
## [35,] 33.63111 34.54489</code></pre>
</div>
<div id="process-capability-analysis" class="section level1">
<h1 class="hasAnchor">
<a href="#process-capability-analysis" class="anchor"></a>Process capability analysis</h1>
<div class="sourceCode" id="cb60"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="no">pistonrings</span>)
<span class="no">diameter</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/qccGroups.html">qccGroups</a></span>(<span class="no">diameter</span>, <span class="no">sample</span>, <span class="kw">data</span> <span class="kw">=</span> <span class="no">pistonrings</span>)

<span class="no">q</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/qcc.html">qcc</a></span>(<span class="no">diameter</span>[<span class="fl">1</span>:<span class="fl">25</span>,], <span class="kw">type</span><span class="kw">=</span><span class="st">"xbar"</span>, <span class="kw">nsigmas</span><span class="kw">=</span><span class="fl">3</span>, <span class="kw">plot</span><span class="kw">=</span><span class="fl">FALSE</span>)

<span class="fu"><a href="../reference/processCapability.html">processCapability</a></span>(<span class="no">q</span>, <span class="kw">spec.limits</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">73.95</span>,<span class="fl">74.05</span>))</pre></body></html></div>
<p><img src="qcc_files/figure-html/unnamed-chunk-25-1.png" width="90%" style="display: block; margin: auto;"></p>
<pre><code><a href="../reference/processCapability.html">## ── Process Capability Analysis ─────────────────── 
## 
## Number of obs = 125          Target = 74      
## Center        = 74.00118     LSL    = 73.95   
## StdDev        = 0.009785039  USL    = 74.05   
##                   
## Capability indices  Value  2.5%  97.5%
##               Cp     1.70  1.49   1.91
##               Cp_l   1.74  1.55   1.93
##               Cp_u   1.66  1.48   1.84
##               Cp_k   1.66  1.45   1.88
##               Cpm    1.69  1.48   1.90
## 
## Exp&lt;LSL 0%    Obs&lt;LSL 0%
## Exp&gt;USL 0%    Obs&gt;USL 0%

processCapability(q, spec.limits=c(73.95,74.05), target=74.02)</a></code></pre>
<p><img src="qcc_files/figure-html/unnamed-chunk-25-2.png" width="90%" style="display: block; margin: auto;"></p>
<pre><code><a href="../reference/processCapability.html">## ── Process Capability Analysis ─────────────────── 
## 
## Number of obs = 125          Target = 74.02   
## Center        = 74.00118     LSL    = 73.95   
## StdDev        = 0.009785039  USL    = 74.05   
##                   
## Capability indices  Value   2.5%  97.5%
##               Cp    1.703  1.491  1.915
##               Cp_l  1.743  1.555  1.932
##               Cp_u  1.663  1.483  1.844
##               Cp_k  1.663  1.448  1.878
##               Cpm   0.786  0.656  0.915
## 
## Exp&lt;LSL 0%    Obs&lt;LSL 0%
## Exp&gt;USL 0%    Obs&gt;USL 0%

processCapability(q, spec.limits=c(73.99,74.01))</a></code></pre>
<p><img src="qcc_files/figure-html/unnamed-chunk-25-3.png" width="90%" style="display: block; margin: auto;"></p>
<pre><code><a href="../reference/processCapability.html">## ── Process Capability Analysis ─────────────────── 
## 
## Number of obs = 125          Target = 74      
## Center        = 74.00118     LSL    = 73.99   
## StdDev        = 0.009785039  USL    = 74.01   
##                   
## Capability indices  Value   2.5%  97.5%
##               Cp    0.341  0.298  0.383
##               Cp_l  0.381  0.318  0.444
##               Cp_u  0.301  0.242  0.359
##               Cp_k  0.301  0.231  0.370
##               Cpm   0.338  0.296  0.380
## 
## Exp&lt;LSL 0.13%     Obs&lt;LSL 0.12%
## Exp&gt;USL 0.18%     Obs&gt;USL 0.16%

processCapability(q, spec.limits = c(73.99, 74.1))</a></code></pre>
<p><img src="qcc_files/figure-html/unnamed-chunk-25-4.png" width="90%" style="display: block; margin: auto;"></p>
<pre><code>## ── Process Capability Analysis ─────────────────── 
## 
## Number of obs = 125          Target = 74.045  
## Center        = 74.00118     LSL    = 73.99   
## StdDev        = 0.009785039  USL    = 74.1    
##                   
## Capability indices  Value   2.5%  97.5%
##               Cp    1.874  1.641  2.106
##               Cp_l  0.381  0.318  0.444
##               Cp_u  3.367  3.011  3.722
##               Cp_k  0.381  0.305  0.456
##               Cpm   0.408  0.338  0.479
## 
## Exp&lt;LSL 0.13%     Obs&lt;LSL 0.12%
## Exp&gt;USL 0%    Obs&gt;USL 0%</code></pre>
</div>
<div id="multivariate-quality-control-charts" class="section level1">
<h1 class="hasAnchor">
<a href="#multivariate-quality-control-charts" class="anchor"></a>Multivariate Quality Control Charts</h1>
<p>Multivariate subgrouped data from Ryan (2011, Table 9.2) with <span class="math inline">\(p = 2\)</span> variables, <span class="math inline">\(m = 20\)</span> samples, and <span class="math inline">\(n = 4\)</span> sample size for each sample:</p>
<div class="sourceCode" id="cb65"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="no">RyanMultivar</span>)
(<span class="no">q</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/mqcc.html">mqcc</a></span>(<span class="no">RyanMultivar</span>, <span class="kw">type</span> <span class="kw">=</span> <span class="st">"T2"</span>))</pre></body></html></div>
<p><img src="qcc_files/figure-html/unnamed-chunk-26-1.png" width="90%" style="display: block; margin: auto;"></p>
<pre><code><a href="../reference/ellipseChart.html">## ── Multivariate Quality Control Chart ──────────── 
## 
## Chart type                 = T2 
## Data (phase I)             = RyanMultivar 
## Number of groups           = 20 
## Group sample size          = 4 
## Center = 
##      X1      X2 
## 60.3750 18.4875 
## Covariance matrix = 
##          X1        X2
## X1 222.0333 103.11667
## X2 103.1167  56.57917
## |S| = 1929.414 
## 
## Control limits:
##  LCL      UCL
##    0 11.03976

ellipseChart(q)</a></code></pre>
<p><img src="qcc_files/figure-html/unnamed-chunk-26-2.png" width="90%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb67"><html><body><pre class="r">
<span class="fu"><a href="../reference/ellipseChart.html">ellipseChart</a></span>(<span class="no">q</span>, <span class="kw">show.id</span> <span class="kw">=</span> <span class="fl">TRUE</span>)</pre></body></html></div>
<p><img src="qcc_files/figure-html/unnamed-chunk-26-3.png" width="90%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb68"><html><body><pre class="r">
<span class="no">q</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/mqcc.html">mqcc</a></span>(<span class="no">RyanMultivar</span>, <span class="kw">type</span> <span class="kw">=</span> <span class="st">"T2"</span>, <span class="kw">pred.limits</span> <span class="kw">=</span> <span class="fl">TRUE</span>)</pre></body></html></div>
<p><img src="qcc_files/figure-html/unnamed-chunk-26-4.png" width="90%" style="display: block; margin: auto;"></p>
<p>Ryan (2011) discussed Xbar-charts for single variables computed adjusting the confidence level of the <span class="math inline">\(T^2\)</span> chart:</p>
<div class="sourceCode" id="cb69"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span>(<span class="no">RyanMultivar</span>,
     <span class="fu"><a href="../reference/qcc.html">qcc</a></span>(<span class="no">X1</span>, <span class="kw">type</span> <span class="kw">=</span> <span class="st">"xbar"</span>, <span class="kw">confidence.level</span> <span class="kw">=</span> <span class="no">q</span>$<span class="no">confidence.level</span>^(<span class="fl">1</span>/<span class="fl">2</span>)))</pre></body></html></div>
<p><img src="qcc_files/figure-html/unnamed-chunk-27-1.png" width="90%" style="display: block; margin: auto;"></p>
<pre><code><a href="https://rdrr.io/r/base/with.html">## ── Quality Control Chart ───────────────────────── 
## 
## Chart type                 = xbar 
## Data (phase I)             = X1 
## Number of groups           = 20 
## Group sample size          = 4 
## Center of group statistics = 60.375 
## Standard deviation         = 14.93443 
## 
## Control limits at nsigmas  = 2.999977 
##       LCL      UCL
##  37.97352 82.77648

with(RyanMultivar, 
     qcc(X2, type = "xbar", confidence.level = q$confidence.level^(1/2)))</a></code></pre>
<p><img src="qcc_files/figure-html/unnamed-chunk-27-2.png" width="90%" style="display: block; margin: auto;"></p>
<pre><code>## ── Quality Control Chart ───────────────────────── 
## 
## Chart type                 = xbar 
## Data (phase I)             = X2 
## Number of groups           = 20 
## Group sample size          = 4 
## Center of group statistics = 18.4875 
## Standard deviation         = 7.139388 
## 
## Control limits at nsigmas  = 2.999977 
##     LCL     UCL
##  7.7785 29.1965</code></pre>
<p>Generate new “in control” data:</p>
<div class="sourceCode" id="cb72"><html><body><pre class="r"><span class="no">Xnew</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">X1</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="fl">NA</span>, <span class="fl">10</span>, <span class="fl">4</span>), <span class="kw">X2</span> <span class="kw">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="fl">NA</span>, <span class="fl">10</span>, <span class="fl">4</span>))
<span class="kw">for</span>(<span class="no">i</span> <span class="kw">in</span> <span class="fl">1</span>:<span class="fl">4</span>)
   { <span class="no">x</span> <span class="kw">&lt;-</span> <span class="kw pkg">MASS</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/mvrnorm.html">mvrnorm</a></span>(<span class="fl">10</span>, <span class="kw">mu</span> <span class="kw">=</span> <span class="no">q</span>$<span class="no">center</span>, <span class="kw">Sigma</span> <span class="kw">=</span> <span class="no">q</span>$<span class="no">cov</span>)
     <span class="no">Xnew</span>$<span class="no">X1</span>[,<span class="no">i</span>] <span class="kw">&lt;-</span> <span class="no">x</span>[,<span class="fl">1</span>]
     <span class="no">Xnew</span>$<span class="no">X2</span>[,<span class="no">i</span>] <span class="kw">&lt;-</span> <span class="no">x</span>[,<span class="fl">2</span>]
   }
(<span class="no">q</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/mqcc.html">mqcc</a></span>(<span class="no">RyanMultivar</span>, <span class="kw">type</span> <span class="kw">=</span> <span class="st">"T2"</span>, <span class="kw">newdata</span> <span class="kw">=</span> <span class="no">Xnew</span>, <span class="kw">pred.limits</span> <span class="kw">=</span> <span class="fl">TRUE</span>))</pre></body></html></div>
<p><img src="qcc_files/figure-html/unnamed-chunk-28-1.png" width="90%" style="display: block; margin: auto;"></p>
<pre><code><a href="../reference/ellipseChart.html">## ── Multivariate Quality Control Chart ──────────── 
## 
## Chart type                 = T2 
## Data (phase I)             = RyanMultivar 
## Number of groups           = 20 
## Group sample size          = 4 
## Center = 
##      X1      X2 
## 60.3750 18.4875 
## Covariance matrix = 
##          X1        X2
## X1 222.0333 103.11667
## X2 103.1167  56.57917
## |S| = 1929.414 
## 
## New data (phase II)        = Xnew 
## Number of groups           = 10 
## Group sample size          = 4 
## 
## Control limits:
##  LCL      UCL
##    0 11.03976
## 
## Prediction limits:
##  LPL      UPL
##    0 12.20184
ellipseChart(q, show.id = TRUE)</a></code></pre>
<p><img src="qcc_files/figure-html/unnamed-chunk-28-2.png" width="90%" style="display: block; margin: auto;"></p>
<p>Generate new “out of control” data:</p>
<div class="sourceCode" id="cb74"><html><body><pre class="r"><span class="no">Xnew</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">X1</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="fl">NA</span>, <span class="fl">10</span>, <span class="fl">4</span>), <span class="kw">X2</span> <span class="kw">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="fl">NA</span>, <span class="fl">10</span>, <span class="fl">4</span>))
<span class="kw">for</span>(<span class="no">i</span> <span class="kw">in</span> <span class="fl">1</span>:<span class="fl">4</span>)
   { <span class="no">x</span> <span class="kw">&lt;-</span> <span class="kw pkg">MASS</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/mvrnorm.html">mvrnorm</a></span>(<span class="fl">10</span>, <span class="kw">mu</span> <span class="kw">=</span> <span class="fl">1.2</span>*<span class="no">q</span>$<span class="no">center</span>, <span class="kw">Sigma</span> <span class="kw">=</span> <span class="no">q</span>$<span class="no">cov</span>)
     <span class="no">Xnew</span>$<span class="no">X1</span>[,<span class="no">i</span>] <span class="kw">&lt;-</span> <span class="no">x</span>[,<span class="fl">1</span>]
     <span class="no">Xnew</span>$<span class="no">X2</span>[,<span class="no">i</span>] <span class="kw">&lt;-</span> <span class="no">x</span>[,<span class="fl">2</span>]
   }
(<span class="no">q</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/mqcc.html">mqcc</a></span>(<span class="no">RyanMultivar</span>, <span class="kw">type</span> <span class="kw">=</span> <span class="st">"T2"</span>, <span class="kw">newdata</span> <span class="kw">=</span> <span class="no">Xnew</span>, <span class="kw">pred.limits</span> <span class="kw">=</span> <span class="fl">TRUE</span>))</pre></body></html></div>
<p><img src="qcc_files/figure-html/unnamed-chunk-29-1.png" width="90%" style="display: block; margin: auto;"></p>
<pre><code><a href="../reference/ellipseChart.html">## ── Multivariate Quality Control Chart ──────────── 
## 
## Chart type                 = T2 
## Data (phase I)             = RyanMultivar 
## Number of groups           = 20 
## Group sample size          = 4 
## Center = 
##      X1      X2 
## 60.3750 18.4875 
## Covariance matrix = 
##          X1        X2
## X1 222.0333 103.11667
## X2 103.1167  56.57917
## |S| = 1929.414 
## 
## New data (phase II)        = Xnew 
## Number of groups           = 10 
## Group sample size          = 4 
## 
## Control limits:
##  LCL      UCL
##    0 11.03976
## 
## Prediction limits:
##  LPL      UPL
##    0 12.20184
ellipseChart(q, show.id = TRUE)</a></code></pre>
<p><img src="qcc_files/figure-html/unnamed-chunk-29-2.png" width="90%" style="display: block; margin: auto;"></p>
<p>Individual observations data:</p>
<div class="sourceCode" id="cb76"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="no">boiler</span>)
(<span class="no">q</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/mqcc.html">mqcc</a></span>(<span class="no">boiler</span>, <span class="kw">type</span> <span class="kw">=</span> <span class="st">"T2.single"</span>, <span class="kw">confidence.level</span> <span class="kw">=</span> <span class="fl">0.999</span>))</pre></body></html></div>
<p><img src="qcc_files/figure-html/unnamed-chunk-30-1.png" width="90%" style="display: block; margin: auto;"></p>
<pre><code>## ── Multivariate Quality Control Chart ──────────── 
## 
## Chart type                 = T2.single 
## Data (phase I)             = boiler 
## Number of groups           = 25 
## Group sample size          = 1 
## Center = 
##     t1     t2     t3     t4     t5     t6     t7     t8 
## 525.00 513.56 538.92 521.68 503.80 512.44 478.72 477.24 
## Covariance matrix = 
##            t1        t2        t3         t4         t5         t6         t7
## t1 54.0000000 0.9583333 20.583333 31.2916667 20.3333333 -2.2916667 20.3750000
## t2  0.9583333 4.8400000  2.963333  2.6866667  0.3250000  3.0766667  0.7050000
## t3 20.5833333 2.9633333 22.993333 10.0566667  4.9833333  2.0366667  6.4766667
## t4 31.2916667 2.6866667 10.056667 22.3100000 13.5583333 -2.2700000 12.6983333
## t5 20.3333333 0.3250000  4.983333 13.5583333 11.4166667 -1.6583333 10.6500000
## t6 -2.2916667 3.0766667  2.036667 -2.2700000 -1.6583333  4.5066667 -0.7466667
## t7 20.3750000 0.7050000  6.476667 12.6983333 10.6500000 -0.7466667 11.6266667
## t8  0.2083333 3.4433333  2.770000  0.1633333 -0.2833333  3.7233333  0.5283333
##            t8
## t1  0.2083333
## t2  3.4433333
## t3  2.7700000
## t4  0.1633333
## t5 -0.2833333
## t6  3.7233333
## t7  0.5283333
## t8  3.8566667
## |S| = 8313.241 
## 
## Control limits:
##  LCL      UCL
##    0 17.41705</code></pre>
<p>Generate new “in control” data:</p>
<div class="sourceCode" id="cb78"><html><body><pre class="r"><span class="no">boilerNew</span> <span class="kw">&lt;-</span> <span class="kw pkg">MASS</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/mvrnorm.html">mvrnorm</a></span>(<span class="fl">10</span>, <span class="kw">mu</span> <span class="kw">=</span> <span class="no">q</span>$<span class="no">center</span>, <span class="kw">Sigma</span> <span class="kw">=</span> <span class="no">q</span>$<span class="no">cov</span>)
<span class="fu"><a href="../reference/mqcc.html">mqcc</a></span>(<span class="no">boiler</span>, <span class="kw">type</span> <span class="kw">=</span> <span class="st">"T2.single"</span>, <span class="kw">confidence.level</span> <span class="kw">=</span> <span class="fl">0.999</span>,
     <span class="kw">newdata</span> <span class="kw">=</span> <span class="no">boilerNew</span>, <span class="kw">pred.limits</span> <span class="kw">=</span> <span class="fl">TRUE</span>)</pre></body></html></div>
<p><img src="qcc_files/figure-html/unnamed-chunk-31-1.png" width="90%" style="display: block; margin: auto;"></p>
<pre><code>## ── Multivariate Quality Control Chart ──────────── 
## 
## Chart type                 = T2.single 
## Data (phase I)             = boiler 
## Number of groups           = 25 
## Group sample size          = 1 
## Center = 
##     t1     t2     t3     t4     t5     t6     t7     t8 
## 525.00 513.56 538.92 521.68 503.80 512.44 478.72 477.24 
## Covariance matrix = 
##            t1        t2        t3         t4         t5         t6         t7
## t1 54.0000000 0.9583333 20.583333 31.2916667 20.3333333 -2.2916667 20.3750000
## t2  0.9583333 4.8400000  2.963333  2.6866667  0.3250000  3.0766667  0.7050000
## t3 20.5833333 2.9633333 22.993333 10.0566667  4.9833333  2.0366667  6.4766667
## t4 31.2916667 2.6866667 10.056667 22.3100000 13.5583333 -2.2700000 12.6983333
## t5 20.3333333 0.3250000  4.983333 13.5583333 11.4166667 -1.6583333 10.6500000
## t6 -2.2916667 3.0766667  2.036667 -2.2700000 -1.6583333  4.5066667 -0.7466667
## t7 20.3750000 0.7050000  6.476667 12.6983333 10.6500000 -0.7466667 11.6266667
## t8  0.2083333 3.4433333  2.770000  0.1633333 -0.2833333  3.7233333  0.5283333
##            t8
## t1  0.2083333
## t2  3.4433333
## t3  2.7700000
## t4  0.1633333
## t5 -0.2833333
## t6  3.7233333
## t7  0.5283333
## t8  3.8566667
## |S| = 8313.241 
## 
## New data (phase II)        = boilerNew 
## Number of groups           = 10 
## Group sample size          = 1 
## 
## Control limits:
##  LCL      UCL
##    0 17.41705
## 
## Prediction limits:
##  LPL      UPL
##    0 70.02943</code></pre>
<p>Generate new “out of control” data:</p>
<div class="sourceCode" id="cb80"><html><body><pre class="r"><span class="no">boilerNew</span> <span class="kw">&lt;-</span> <span class="kw pkg">MASS</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/mvrnorm.html">mvrnorm</a></span>(<span class="fl">10</span>, <span class="kw">mu</span> <span class="kw">=</span> <span class="fl">1.01</span>*<span class="no">q</span>$<span class="no">center</span>, <span class="kw">Sigma</span> <span class="kw">=</span> <span class="no">q</span>$<span class="no">cov</span>)
<span class="fu"><a href="../reference/mqcc.html">mqcc</a></span>(<span class="no">boiler</span>, <span class="kw">type</span> <span class="kw">=</span> <span class="st">"T2.single"</span>, <span class="kw">confidence.level</span> <span class="kw">=</span> <span class="fl">0.999</span>,
     <span class="kw">newdata</span> <span class="kw">=</span> <span class="no">boilerNew</span>, <span class="kw">pred.limits</span> <span class="kw">=</span> <span class="fl">TRUE</span>)</pre></body></html></div>
<p><img src="qcc_files/figure-html/unnamed-chunk-32-1.png" width="90%" style="display: block; margin: auto;"></p>
<pre><code>## ── Multivariate Quality Control Chart ──────────── 
## 
## Chart type                 = T2.single 
## Data (phase I)             = boiler 
## Number of groups           = 25 
## Group sample size          = 1 
## Center = 
##     t1     t2     t3     t4     t5     t6     t7     t8 
## 525.00 513.56 538.92 521.68 503.80 512.44 478.72 477.24 
## Covariance matrix = 
##            t1        t2        t3         t4         t5         t6         t7
## t1 54.0000000 0.9583333 20.583333 31.2916667 20.3333333 -2.2916667 20.3750000
## t2  0.9583333 4.8400000  2.963333  2.6866667  0.3250000  3.0766667  0.7050000
## t3 20.5833333 2.9633333 22.993333 10.0566667  4.9833333  2.0366667  6.4766667
## t4 31.2916667 2.6866667 10.056667 22.3100000 13.5583333 -2.2700000 12.6983333
## t5 20.3333333 0.3250000  4.983333 13.5583333 11.4166667 -1.6583333 10.6500000
## t6 -2.2916667 3.0766667  2.036667 -2.2700000 -1.6583333  4.5066667 -0.7466667
## t7 20.3750000 0.7050000  6.476667 12.6983333 10.6500000 -0.7466667 11.6266667
## t8  0.2083333 3.4433333  2.770000  0.1633333 -0.2833333  3.7233333  0.5283333
##            t8
## t1  0.2083333
## t2  3.4433333
## t3  2.7700000
## t4  0.1633333
## t5 -0.2833333
## t6  3.7233333
## t7  0.5283333
## t8  3.8566667
## |S| = 8313.241 
## 
## New data (phase II)        = boilerNew 
## Number of groups           = 10 
## Group sample size          = 1 
## 
## Control limits:
##  LCL      UCL
##    0 17.41705
## 
## Prediction limits:
##  LPL      UPL
##    0 70.02943</code></pre>
<p>Recompute by providing “robust” estimates for the means and the covariance matrix:</p>
<div class="sourceCode" id="cb82"><html><body><pre class="r"><span class="no">rob</span> <span class="kw">&lt;-</span> <span class="kw pkg">MASS</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/cov.rob.html">cov.rob</a></span>(<span class="no">boiler</span>)
<span class="fu"><a href="../reference/mqcc.html">mqcc</a></span>(<span class="no">boiler</span>, <span class="kw">type</span> <span class="kw">=</span> <span class="st">"T2.single"</span>, <span class="kw">center</span> <span class="kw">=</span> <span class="no">rob</span>$<span class="no">center</span>, <span class="kw">cov</span> <span class="kw">=</span> <span class="no">rob</span>$<span class="no">cov</span>)</pre></body></html></div>
<p><img src="qcc_files/figure-html/unnamed-chunk-33-1.png" width="90%" style="display: block; margin: auto;"></p>
<pre><code>## ── Multivariate Quality Control Chart ──────────── 
## 
## Chart type                 = T2.single 
## Data (phase I)             = boiler 
## Number of groups           = 25 
## Group sample size          = 1 
## Center = 
##       t1       t2       t3       t4       t5       t6       t7       t8 
## 526.0455 513.4545 540.2273 521.7727 503.9091 512.5909 479.0000 477.3636 
## Covariance matrix = 
##           t1        t2         t3         t4         t5         t6         t7
## t1 34.045455 2.7878788 12.3701299 25.7251082 16.2900433 -4.5043290 14.2857143
## t2  2.787879 5.2121212  4.9870130  3.4891775  0.8051948  3.5281385  1.4761905
## t3 12.370130 4.9870130 10.3744589 10.9112554  4.4978355  0.9545455  4.1428571
## t4 25.725108 3.4891775 10.9112554 20.7554113 12.4069264 -3.0021645 11.0476190
## t5 16.290043 0.8051948  4.4978355 12.4069264 10.9437229 -2.1341991  9.7142857
## t6 -4.504329 3.5281385  0.9545455 -3.0021645 -2.1341991  4.8246753 -1.2857143
## t7 14.285714 1.4761905  4.1428571 11.0476190  9.7142857 -1.2857143 10.1904762
## t8 -1.398268 3.9220779  2.1038961 -0.1991342 -0.5367965  3.9653680  0.2380952
##            t8
## t1 -1.3982684
## t2  3.9220779
## t3  2.1038961
## t4 -0.1991342
## t5 -0.5367965
## t6  3.9653680
## t7  0.2380952
## t8  4.1471861
## |S| = 316.2932 
## 
## Control limits:
##  LCL      UCL
##    0 14.26225</code></pre>
</div>
<div id="pareto-chart" class="section level1">
<h1 class="hasAnchor">
<a href="#pareto-chart" class="anchor"></a>Pareto chart</h1>
<div class="sourceCode" id="cb84"><html><body><pre class="r"><span class="no">defect</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">80</span>, <span class="fl">27</span>, <span class="fl">66</span>, <span class="fl">94</span>, <span class="fl">33</span>)
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="no">defect</span>) <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"price code"</span>, <span class="st">"schedule date"</span>, <span class="st">"supplier code"</span>, <span class="st">"contact num."</span>, <span class="st">"part num."</span>)
<span class="fu"><a href="../reference/paretoChart.html">paretoChart</a></span>(<span class="no">defect</span>, <span class="kw">ylab</span> <span class="kw">=</span> <span class="st">"Error frequency"</span>)</pre></body></html></div>
<p><img src="qcc_files/figure-html/unnamed-chunk-34-1.png" width="90%" style="display: block; margin: auto;"></p>
<pre><code>## ── Pareto Chart ────────────────────────────────── 
##                
## defect          Frequency Cum.Freq. Percentage Cum.Percent.
##   contact num.         94        94      31.33        31.33
##   price code           80       174      26.67        58.00
##   supplier code        66       240      22.00        80.00
##   part num.            33       273      11.00        91.00
##   schedule date        27       300       9.00       100.00</code></pre>
</div>
<div id="cause-and-effect-diagram" class="section level1">
<h1 class="hasAnchor">
<a href="#cause-and-effect-diagram" class="anchor"></a>Cause and effect diagram</h1>
<div class="sourceCode" id="cb86"><html><body><pre class="r"><span class="fu"><a href="../reference/causeEffectDiagram.html">causeEffectDiagram</a></span>(<span class="kw">cause</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">Measurements</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Micrometers"</span>,
                                                 <span class="st">"Microscopes"</span>,
                                                 <span class="st">"Inspectors"</span>),
                                <span class="kw">Materials</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Alloys"</span>,
                                              <span class="st">"Lubricants"</span>,
                                              <span class="st">"Suppliers"</span>),
                                <span class="kw">Personnel</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Shifts"</span>,
                                              <span class="st">"Supervisors"</span>,
                                              <span class="st">"Training"</span>,
                                              <span class="st">"Operators"</span>),
                                <span class="kw">Environment</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Condensation"</span>,
                                                <span class="st">"Moisture"</span>),
                                <span class="kw">Methods</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Brake"</span>,
                                            <span class="st">"Engager"</span>,
                                            <span class="st">"Angle"</span>),
                                <span class="kw">Machines</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Speed"</span>,
                                             <span class="st">"Lathes"</span>,
                                             <span class="st">"Bits"</span>,
                                             <span class="st">"Sockets"</span>)),
                   <span class="kw">effect</span> <span class="kw">=</span> <span class="st">"Surface Flaws"</span>)</pre></body></html></div>
<p><img src="qcc_files/figure-html/unnamed-chunk-35-1.png" width="90%" style="display: block; margin: auto;"></p>
</div>
<div id="process-variation-examples" class="section level1">
<h1 class="hasAnchor">
<a href="#process-variation-examples" class="anchor"></a>Process variation examples</h1>
<p>In the following simulated data are used to describe some models for process variation. For further details see Wetherill, G.B. and Brown, D.W. (1991) <em>Statistical Process Control</em>, New York, Chapman and Hall, Chapter 3.</p>
<div id="simple-random-variation" class="section level2">
<h2 class="hasAnchor">
<a href="#simple-random-variation" class="anchor"></a>Simple random variation</h2>
<p><span class="math inline">\(x_{ij} = \mu + \sigma_W \epsilon_{ij}\)</span></p>
<div class="sourceCode" id="cb87"><html><body><pre class="r"><span class="no">mu</span> <span class="kw">&lt;-</span> <span class="fl">100</span>
<span class="no">sigma_W</span> <span class="kw">&lt;-</span> <span class="fl">10</span>
<span class="no">epsilon</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="fl">500</span>)
<span class="no">x</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="no">mu</span> + <span class="no">sigma_W</span>*<span class="no">epsilon</span>, <span class="kw">ncol</span><span class="kw">=</span><span class="fl">10</span>, <span class="kw">byrow</span><span class="kw">=</span><span class="fl">TRUE</span>)
<span class="no">q</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/qcc.html">qcc</a></span>(<span class="no">x</span>, <span class="kw">type</span><span class="kw">=</span><span class="st">"xbar"</span>)</pre></body></html></div>
<p><img src="qcc_files/figure-html/unnamed-chunk-37-1.png" width="90%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb88"><html><body><pre class="r"><span class="no">q</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/qcc.html">qcc</a></span>(<span class="no">x</span>, <span class="kw">type</span><span class="kw">=</span><span class="st">"R"</span>)</pre></body></html></div>
<p><img src="qcc_files/figure-html/unnamed-chunk-37-2.png" width="90%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb89"><html><body><pre class="r"><span class="no">q</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/qcc.html">qcc</a></span>(<span class="no">x</span>, <span class="kw">type</span><span class="kw">=</span><span class="st">"S"</span>)</pre></body></html></div>
<p><img src="qcc_files/figure-html/unnamed-chunk-37-3.png" width="90%" style="display: block; margin: auto;"></p>
</div>
<div id="between-and-within-sample-extra-variation" class="section level2">
<h2 class="hasAnchor">
<a href="#between-and-within-sample-extra-variation" class="anchor"></a>Between and within sample extra variation</h2>
<p><span class="math inline">\(x_{ij} = \mu + \sigma_B u_i + \sigma_W \epsilon_{ij}\)</span></p>
<div class="sourceCode" id="cb90"><html><body><pre class="r"><span class="no">mu</span> <span class="kw">&lt;-</span> <span class="fl">100</span>
<span class="no">sigma_W</span> <span class="kw">&lt;-</span> <span class="fl">10</span>
<span class="no">sigma_B</span> <span class="kw">&lt;-</span> <span class="fl">5</span>
<span class="no">epsilon</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="fl">500</span>)
<span class="no">u</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html">as.vector</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span>(<span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="fl">50</span>), <span class="no">rep</span>, <span class="fl">10</span>))
<span class="no">x</span> <span class="kw">&lt;-</span> <span class="no">mu</span> + <span class="no">sigma_B</span>*<span class="no">u</span> + <span class="no">sigma_W</span>*<span class="no">epsilon</span>
<span class="no">x</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="no">x</span>, <span class="kw">ncol</span><span class="kw">=</span><span class="fl">10</span>, <span class="kw">byrow</span><span class="kw">=</span><span class="fl">TRUE</span>)
<span class="no">q</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/qcc.html">qcc</a></span>(<span class="no">x</span>, <span class="kw">type</span><span class="kw">=</span><span class="st">"xbar"</span>)</pre></body></html></div>
<p><img src="qcc_files/figure-html/unnamed-chunk-38-1.png" width="90%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb91"><html><body><pre class="r"><span class="no">q</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/qcc.html">qcc</a></span>(<span class="no">x</span>, <span class="kw">type</span><span class="kw">=</span><span class="st">"R"</span>)</pre></body></html></div>
<p><img src="qcc_files/figure-html/unnamed-chunk-38-2.png" width="90%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb92"><html><body><pre class="r"><span class="no">q</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/qcc.html">qcc</a></span>(<span class="no">x</span>, <span class="kw">type</span><span class="kw">=</span><span class="st">"S"</span>)</pre></body></html></div>
<p><img src="qcc_files/figure-html/unnamed-chunk-38-3.png" width="90%" style="display: block; margin: auto;"></p>
</div>
<div id="autocorrelation" class="section level2">
<h2 class="hasAnchor">
<a href="#autocorrelation" class="anchor"></a>Autocorrelation</h2>
<p><span class="math inline">\(x_{ij} = \mu + W_i + \sigma_W \epsilon_{ij}\)</span><br>
where <span class="math inline">\(W_i = \rho W_{i-1} + \sigma_B u_i = \sigma_B u_i + \rho \sigma_B u_{i-1} + \rho^2 \sigma_B u_{i-2} + \ldots\)</span>,<br>
and <span class="math inline">\(W_0 = 0\)</span>.</p>
<div class="sourceCode" id="cb93"><html><body><pre class="r"><span class="no">mu</span> <span class="kw">&lt;-</span> <span class="fl">100</span>
<span class="no">rho</span> <span class="kw">&lt;-</span> <span class="fl">0.8</span>
<span class="no">sigma_W</span> <span class="kw">&lt;-</span> <span class="fl">10</span>
<span class="no">sigma_B</span> <span class="kw">&lt;-</span> <span class="fl">5</span>
<span class="no">epsilon</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="fl">500</span>)
<span class="no">u</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="fl">500</span>)
<span class="no">W</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">0</span>,<span class="fl">100</span>)
<span class="kw">for</span>(<span class="no">i</span> <span class="kw">in</span> <span class="fl">2</span>:<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">W</span>))
    <span class="no">W</span>[<span class="no">i</span>] <span class="kw">&lt;-</span> <span class="no">rho</span>*<span class="no">W</span>[<span class="no">i</span>-<span class="fl">1</span>] + <span class="no">sigma_B</span>*<span class="no">u</span>[<span class="no">i</span>]
<span class="no">x</span> <span class="kw">&lt;-</span> <span class="no">mu</span> + <span class="no">sigma_B</span>*<span class="no">u</span> + <span class="no">sigma_W</span>*<span class="no">epsilon</span>
<span class="no">x</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="no">x</span>, <span class="kw">ncol</span><span class="kw">=</span><span class="fl">10</span>, <span class="kw">byrow</span><span class="kw">=</span><span class="fl">TRUE</span>)
<span class="no">q</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/qcc.html">qcc</a></span>(<span class="no">x</span>, <span class="kw">type</span><span class="kw">=</span><span class="st">"xbar"</span>)</pre></body></html></div>
<p><img src="qcc_files/figure-html/unnamed-chunk-39-1.png" width="90%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb94"><html><body><pre class="r"><span class="no">q</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/qcc.html">qcc</a></span>(<span class="no">x</span>, <span class="kw">type</span><span class="kw">=</span><span class="st">"R"</span>)</pre></body></html></div>
<p><img src="qcc_files/figure-html/unnamed-chunk-39-2.png" width="90%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb95"><html><body><pre class="r"><span class="no">q</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/qcc.html">qcc</a></span>(<span class="no">x</span>, <span class="kw">type</span><span class="kw">=</span><span class="st">"S"</span>)</pre></body></html></div>
<p><img src="qcc_files/figure-html/unnamed-chunk-39-3.png" width="90%" style="display: block; margin: auto;"></p>
</div>
<div id="recurring-cycles" class="section level2">
<h2 class="hasAnchor">
<a href="#recurring-cycles" class="anchor"></a>Recurring cycles</h2>
<p>Assume we have 3 working turns of 8 hours each for each working day, so <span class="math inline">\(8 \times 3 = 24\)</span> points in time, and at each point we sample 5 units.</p>
<p><span class="math inline">\(x_{ij} = \mu + W_i + \sigma_W \epsilon_{ij}\)</span><br>
where <span class="math inline">\(W_i\)</span> (<span class="math inline">\(i=1,\ldots,8\)</span>) is the cycle.</p>
<div class="sourceCode" id="cb96"><html><body><pre class="r"><span class="no">mu</span> <span class="kw">&lt;-</span> <span class="fl">100</span>
<span class="no">sigma_W</span> <span class="kw">&lt;-</span> <span class="fl">10</span>
<span class="no">epsilon</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="fl">120</span>, <span class="kw">sd</span><span class="kw">=</span><span class="fl">0.3</span>)
<span class="no">W</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(-<span class="fl">4</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">4</span>, <span class="fl">2</span>, <span class="fl">0</span>, -<span class="fl">2</span>) <span class="co"># assumed workers cycle</span>
<span class="no">W</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="no">W</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">5</span>,<span class="fl">8</span>)), <span class="fl">3</span>)
<span class="no">x</span> <span class="kw">&lt;-</span> <span class="no">mu</span> + <span class="no">W</span> + <span class="no">sigma_W</span>*<span class="no">epsilon</span>
<span class="no">x</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="no">x</span>, <span class="kw">ncol</span><span class="kw">=</span><span class="fl">5</span>, <span class="kw">byrow</span><span class="kw">=</span><span class="fl">TRUE</span>)
<span class="no">q</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/qcc.html">qcc</a></span>(<span class="no">x</span>, <span class="kw">type</span><span class="kw">=</span><span class="st">"xbar"</span>)</pre></body></html></div>
<p><img src="qcc_files/figure-html/unnamed-chunk-40-1.png" width="90%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb97"><html><body><pre class="r"><span class="no">q</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/qcc.html">qcc</a></span>(<span class="no">x</span>, <span class="kw">type</span><span class="kw">=</span><span class="st">"R"</span>)</pre></body></html></div>
<p><img src="qcc_files/figure-html/unnamed-chunk-40-2.png" width="90%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb98"><html><body><pre class="r"><span class="no">q</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/qcc.html">qcc</a></span>(<span class="no">x</span>, <span class="kw">type</span><span class="kw">=</span><span class="st">"S"</span>)</pre></body></html></div>
<p><img src="qcc_files/figure-html/unnamed-chunk-40-3.png" width="90%" style="display: block; margin: auto;"></p>
</div>
<div id="trends" class="section level2">
<h2 class="hasAnchor">
<a href="#trends" class="anchor"></a>Trends</h2>
<p><span class="math inline">\(x_{ij} = \mu + W_i + \sigma_W \epsilon_{ij}\)</span><br>
where <span class="math inline">\(W_i = 0.2 i\)</span></p>
<div class="sourceCode" id="cb99"><html><body><pre class="r"><span class="no">mu</span> <span class="kw">&lt;-</span> <span class="fl">100</span>
<span class="no">sigma_W</span> <span class="kw">&lt;-</span> <span class="fl">10</span>
<span class="no">epsilon</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="fl">500</span>)
<span class="no">W</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">0.2</span>*<span class="fl">1</span>:<span class="fl">100</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">5</span>,<span class="fl">100</span>))
<span class="no">x</span> <span class="kw">&lt;-</span> <span class="no">mu</span> + <span class="no">W</span> + <span class="no">sigma_W</span>*<span class="no">epsilon</span>
<span class="no">x</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="no">x</span>, <span class="kw">ncol</span><span class="kw">=</span><span class="fl">10</span>, <span class="kw">byrow</span><span class="kw">=</span><span class="fl">TRUE</span>)
<span class="no">q</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/qcc.html">qcc</a></span>(<span class="no">x</span>, <span class="kw">type</span><span class="kw">=</span><span class="st">"xbar"</span>)</pre></body></html></div>
<p><img src="qcc_files/figure-html/unnamed-chunk-41-1.png" width="90%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb100"><html><body><pre class="r"><span class="no">q</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/qcc.html">qcc</a></span>(<span class="no">x</span>, <span class="kw">type</span><span class="kw">=</span><span class="st">"R"</span>)</pre></body></html></div>
<p><img src="qcc_files/figure-html/unnamed-chunk-41-2.png" width="90%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb101"><html><body><pre class="r"><span class="no">q</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/qcc.html">qcc</a></span>(<span class="no">x</span>, <span class="kw">type</span><span class="kw">=</span><span class="st">"S"</span>)</pre></body></html></div>
<p><img src="qcc_files/figure-html/unnamed-chunk-41-3.png" width="90%" style="display: block; margin: auto;"></p>
</div>
<div id="mixture" class="section level2">
<h2 class="hasAnchor">
<a href="#mixture" class="anchor"></a>Mixture</h2>
<p><span class="math inline">\(x_{ij} = \mu_1 p + \mu_2 (1-p) + \sigma_W \epsilon_{ij}\)</span><br>
where <span class="math inline">\(p = \Pr(\text{Process #1})\)</span>.</p>
<div class="sourceCode" id="cb102"><html><body><pre class="r"><span class="no">mu1</span> <span class="kw">&lt;-</span> <span class="fl">90</span>
<span class="no">mu2</span> <span class="kw">&lt;-</span> <span class="fl">110</span>
<span class="no">sigma_W</span> <span class="kw">&lt;-</span> <span class="fl">10</span>
<span class="no">epsilon</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="fl">500</span>)
<span class="no">p</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">rbinom</a></span>(<span class="fl">50</span>, <span class="fl">1</span>, <span class="fl">0.5</span>)
<span class="no">mu</span> <span class="kw">&lt;-</span> <span class="no">mu1</span>*<span class="no">p</span> + <span class="no">mu2</span>*(<span class="fl">1</span>-<span class="no">p</span>)
<span class="no">x</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="no">mu</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">10</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">mu</span>))) + <span class="no">sigma_W</span>*<span class="no">epsilon</span>
<span class="no">x</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="no">x</span>, <span class="kw">ncol</span><span class="kw">=</span><span class="fl">10</span>, <span class="kw">byrow</span><span class="kw">=</span><span class="fl">TRUE</span>)
<span class="no">q</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/qcc.html">qcc</a></span>(<span class="no">x</span>, <span class="kw">type</span><span class="kw">=</span><span class="st">"xbar"</span>)</pre></body></html></div>
<p><img src="qcc_files/figure-html/unnamed-chunk-42-1.png" width="90%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb103"><html><body><pre class="r"><span class="no">q</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/qcc.html">qcc</a></span>(<span class="no">x</span>, <span class="kw">type</span><span class="kw">=</span><span class="st">"R"</span>)</pre></body></html></div>
<p><img src="qcc_files/figure-html/unnamed-chunk-42-2.png" width="90%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb104"><html><body><pre class="r"><span class="no">q</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/qcc.html">qcc</a></span>(<span class="no">x</span>, <span class="kw">type</span><span class="kw">=</span><span class="st">"S"</span>)</pre></body></html></div>
<p><img src="qcc_files/figure-html/unnamed-chunk-42-3.png" width="90%" style="display: block; margin: auto;"></p>
</div>
<div id="sudden-jumps" class="section level2">
<h2 class="hasAnchor">
<a href="#sudden-jumps" class="anchor"></a>Sudden jumps</h2>
<p><span class="math inline">\(x_{ij} = \mu_i + \sigma_W \epsilon_{ij}\)</span><br>
where <span class="math inline">\(\mu_i\)</span> is the mean of the process for state <span class="math inline">\(i\)</span> (<span class="math inline">\(i=1,\ldots,k)\)</span>.</p>
<div class="sourceCode" id="cb105"><html><body><pre class="r"><span class="no">mu</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">95</span>,<span class="fl">110</span>,<span class="fl">100</span>,<span class="fl">90</span>), <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">20</span>,<span class="fl">35</span>,<span class="fl">25</span>,<span class="fl">20</span>))
<span class="no">sigma_W</span> <span class="kw">&lt;-</span> <span class="fl">10</span>
<span class="no">epsilon</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="fl">500</span>)
<span class="no">x</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="no">mu</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">5</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">mu</span>))) + <span class="no">sigma_W</span>*<span class="no">epsilon</span>
<span class="no">x</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="no">x</span>, <span class="kw">ncol</span><span class="kw">=</span><span class="fl">10</span>, <span class="kw">byrow</span><span class="kw">=</span><span class="fl">TRUE</span>)
<span class="no">q</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/qcc.html">qcc</a></span>(<span class="no">x</span>, <span class="kw">type</span><span class="kw">=</span><span class="st">"xbar"</span>)</pre></body></html></div>
<p><img src="qcc_files/figure-html/unnamed-chunk-43-1.png" width="90%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb106"><html><body><pre class="r"><span class="no">q</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/qcc.html">qcc</a></span>(<span class="no">x</span>, <span class="kw">type</span><span class="kw">=</span><span class="st">"R"</span>)</pre></body></html></div>
<p><img src="qcc_files/figure-html/unnamed-chunk-43-2.png" width="90%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb107"><html><body><pre class="r"><span class="no">q</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/qcc.html">qcc</a></span>(<span class="no">x</span>, <span class="kw">type</span><span class="kw">=</span><span class="st">"S"</span>)</pre></body></html></div>
<p><img src="qcc_files/figure-html/unnamed-chunk-43-3.png" width="90%" style="display: block; margin: auto;"></p>
</div>
</div>
<div id="references" class="section level1">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<p>Montgomery, D.C. (2009) <em>Introduction to Statistical Quality Control</em>, 6th ed. New York: John Wiley &amp; Sons.</p>
<p>Ryan, T. P. (2011), <em>Statistical Methods for Quality Improvement</em>, 3rd ed. New York: John Wiley &amp; Sons.</p>
<p>Scrucca, L. (2004) <a href="http://www.stat.unipg.it/luca/misc/Rnews_2004-1-pag11-17.pdf">qcc: an R package for quality control charting and statistical process control</a>. <em>R News</em> 4/1, 11-17.</p>
<hr>
<div class="sourceCode" id="cb108"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html">sessionInfo</a></span>()
<span class="co">## R version 3.6.3 (2020-02-29)</span>
<span class="co">## Platform: x86_64-apple-darwin15.6.0 (64-bit)</span>
<span class="co">## Running under: macOS Catalina 10.15.4</span>
<span class="co">## </span>
<span class="co">## Matrix products: default</span>
<span class="co">## BLAS:   /Library/Frameworks/R.framework/Versions/3.6/Resources/lib/libRblas.0.dylib</span>
<span class="co">## LAPACK: /Library/Frameworks/R.framework/Versions/3.6/Resources/lib/libRlapack.dylib</span>
<span class="co">## </span>
<span class="co">## locale:</span>
<span class="co">## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8</span>
<span class="co">## </span>
<span class="co">## attached base packages:</span>
<span class="co">## [1] stats     graphics  grDevices utils     datasets  methods   base     </span>
<span class="co">## </span>
<span class="co">## other attached packages:</span>
<span class="co">## [1] qcc_3.0    knitr_1.28</span>
<span class="co">## </span>
<span class="co">## loaded via a namespace (and not attached):</span>
<span class="co">##  [1] Rcpp_1.0.4.6     rstudioapi_0.11  magrittr_1.5     MASS_7.3-51.5   </span>
<span class="co">##  [5] R6_2.4.1         rlang_0.4.5      fansi_0.4.1      stringr_1.4.0   </span>
<span class="co">##  [9] tools_3.6.3      xfun_0.13        cli_2.0.2        htmltools_0.4.0 </span>
<span class="co">## [13] yaml_2.2.1       assertthat_0.2.1 digest_0.6.25    rprojroot_1.3-2 </span>
<span class="co">## [17] pkgdown_1.5.1    crayon_1.3.4     fs_1.4.1         memoise_1.1.0   </span>
<span class="co">## [21] glue_1.4.0       evaluate_0.14    rmarkdown_2.1    stringi_1.4.6   </span>
<span class="co">## [25] compiler_3.6.3   desc_1.2.0       backports_1.1.6</span></pre></body></html></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="http://www.stat.unipg.it/luca">Luca Scrucca</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
